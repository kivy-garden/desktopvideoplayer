<ContextMenu>:
    cols: 1
    size_hint: None, None
    spacing: 0, 0
    spacer: _spacer
    on_visible: self._on_visible(args[1])
    on_parent: self._on_visible(self.visible)

#    canvas.before:
#        Color:
#            rgb: 1.0, 0, 0
#        Rectangle:
#            pos: self.pos
#            size: self.size
    Widget:
        id: _spacer
        size_hint: 1, None
        height: 3
        canvas.before:
            Color:
                rgb: 0.2, 0.71, 0.90
            Rectangle:
                pos: self.pos
                size: self.size

<ContextMenuItem>:
    pos: self.parent.pos
    submenu_arrow: _submenu_arrow
    on_children: self._update_arrows()
    on_parent: self._update_arrows()
    on_hovered: self.show_submenu(self.right, self.top + self.parent.spacer.height) if args[1] else self.hide_submenu()

    canvas.before:
        Color:
            rgb: (0.25, 0.25, 0.25) if self.hovered else (0.15, 0.15, 0.15)
        Rectangle:
            pos: self.pos
            size: self.size

    Widget:
        id: _submenu_arrow
        size_hint: None, None
        width: 6
        height: 11
        pos: self.parent.right - self.width - 5, self.parent.y + ((self.parent.height - self.height) / 2)
        canvas.before:
            Translate:
                xy: self.pos
            Color:
                rgb: (1, 1, 1)
            Triangle:
                points: [0,0, self.width,self.height/2, 0,self.height]
            Translate:
                xy: (-self.pos[0], -self.pos[1])

<ContextMenuTextItem>:
    label: _label
    size_hint: None, None
    size: self.parent.width, 26
    on_text: self.label.text = self.text
#    on_text: self.label.text = self.text + (' ...' if self.get_submenu() else '')

    Label:
        pos: self.parent.pos
        id: _label
        padding: 10, 0
        font_size: '14px'
        halign: 'left'
        valign: 'middle'
        size: self.texture_size
        size_hint: None, 1